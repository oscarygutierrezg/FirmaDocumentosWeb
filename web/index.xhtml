<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <f:metadata>
        <f:event type="preRenderView" listener="#{MbFirma.consultarDocumentos()}" />
        <f:viewParam id="ofertaEconomica" name="ofertaEconomica" value="#{MbFirma.ofertaEconomica}"/>
    </f:metadata>
    <h:head>
        <title>P&#225;gina Web de Firma Electr&#243;nica de Documentos Legales</title>
        <meta http-equiv="X-UA-Compatible" content="IE=7,8,9,10,edge"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <h:outputScript name="jsf.js" library="javax.faces"/>
        <script type="text/javascript" src="js/jquery-1.11.3.min.js" />
        <script type="text/javascript" src="js/bootstrap.js"></script>
        <script type="text/javascript" src="js/bootstrap.min.js"></script>

        <meta charset="utf-8"/>
        <link rel="stylesheet" href="css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
              crossorigin="anonymous"/>
        <link rel="stylesheet" href="css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp"
              crossorigin="anonymous"/>
        <link rel="stylesheet" href="css/style.css" />

        <script type="text/javascript">
            function errorIniciarTOC() {
                // Metodo que se invoca al iniciar el Applet y sirve para informar el status del inicio
                $('#formDocumentos\\:estadoInicioApplet').val(document.myApplet.getStatusInicioApplet());
                $('#formDocumentos\\:estadoRegistro').val(document.myApplet.getStatusRegistro());
                $('#formDocumentos\\:estadoCargaVista').val(document.myApplet.getStatusVista());

                if (!document.myApplet.getStatusInicioApplet() || !document.myApplet.getStatusRegistro() || !document.myApplet.getStatusVista()) {
                    $('#iframePdf').hide();
                    $('#divApplet').hide();
                    $('#notificacionErrorApplet').modal('show');
                }
            }

            function errorInitSecuGen() {
                // Metodo que se invoca cuando ha ocurrido un error al iniciar el lector de huellas
                $('#iframePdf').hide();
                $('#divApplet').hide();
                $('#notificacionErrorApplet').modal('show');
            }

            function errorInitBarcodeReader() {
                // Metodo que se invoca cuando ha ocurrido un error al iniciar el lector de codigos de barras

                // alert("Ha ocurrido un error al iniciar el lector de cedulas de identidad");
            }

            function nuevaVerificacion($run, $textoCabecera) {
                document.myApplet.setDataNuevaVerificacion($run, $textoCabecera);
            }

            function cancelarTOC() {
                // Metodo que se invoca al momento de presionar el boton de cerrar

                alert("Se ha presionado el boton Cancelar TOC");
            }

            function cedulaLeida() {
                // Metodo que se invoca al momento de leer una cedula de identidad

                //  alert("Run corresponde: " + document.myApplet.getRunCorresponde());
                if (!document.myApplet.getRunCorresponde()) {
                    // document.myApplet.cleanFormularioTOC();
                }
            }

            function initVerificacionIdentidadTOC() {
                // Metodo que se invoca al momento de iniciar la verificacion de identidad TOC
            }

            function verificacionIdentidadTOC() {
                // Metodo que se invoca al momento de obtener una verificacion de identidad TOC
                $('#formDocumentos\\:tipoCedula').val(document.myApplet.isNewID());
                if (document.myApplet.isNewID()) {

//                    alert("Resultado Operacion: " + document.myApplet.getCodigoRespuestaNewCI() +
//                            "\nRun: " + document.myApplet.getRunNewCI() +
//                            "\nNombres: " + document.myApplet.getNombresNewCI() +
//                            "\nApellidos: " + document.myApplet.getApellidosNewCI() +
//                            "\nGenero: " + document.myApplet.getGeneroNewCI() +
//                            "\nNacionalidad: " + document.myApplet.getNacionalidadNewCI() +
//                            "\nFecha Nacimiento: " + document.myApplet.getFechaNacimientoNewCI() +
//                            "\nFecha Vencimiento CI: " + document.myApplet.getFechaVencimientoNewCI() +
//                            "\nNumero Serie CI: " + document.myApplet.getNSerieNewCI() +
//                            "\nNumero Transaccion TOC: " + document.myApplet.getNTransaccionNewCI() +
//                            "\nResultado Transaccion: " + document.myApplet.getResultadoVerificacionNewCI() +
//                            "\nCI Vencida: " + document.myApplet.getCIVencidaNewCI());
                    $('#formDocumentos\\:apellidos').val(document.myApplet.getApellidosNewCI());
                    $('#formDocumentos\\:ciVencida').val(document.myApplet.getCIVencidaNewCI());
                    $('#formDocumentos\\:nacionalidad').val(document.myApplet.getNacionalidadNewCI());
                    $('#formDocumentos\\:fechaNacimiento').val(document.myApplet.getFechaNacimientoNewCI());
                    $('#formDocumentos\\:fechaVencimiento').val(document.myApplet.getFechaVencimientoNewCI());
                    $('#formDocumentos\\:genero').val(document.myApplet.getGeneroNewCI());
                    $('#formDocumentos\\:nombres').val(document.myApplet.getNombresNewCI());
                    $('#formDocumentos\\:numeroSerie').val(document.myApplet.getNSerieNewCI());
                    $('#formDocumentos\\:numeroTransaccion').val(document.myApplet.getNTransaccionNewCI());
                    $('#formDocumentos\\:resultadoTransaccion').val(document.myApplet.getResultadoVerificacionNewCI());
                    $('#formDocumentos\\:run').val(document.myApplet.getRunNewCI());




                } else {


                    alert("Resultado Operacion: " + document.myApplet.getCodigoRespuesta() +
                            "\nRun: " + document.myApplet.getRut() +
                            "\nApellido Paterno: " + document.myApplet.getApellidoPaterno() +
                            "\nNombre Completo: " + document.myApplet.getNombreCompleto() +
                            "\nNacionalidad: " + document.myApplet.getNacionalidad() +
                            "\nFecha Vencimiento CI: " + document.myApplet.getFechaVence() +
                            "\nNumero Serie CI: " + document.myApplet.getNumeroSerie() +
                            "\nPuntaje TOC: " + document.myApplet.getResultadoTrx() +
                            "\nNumero Transaccion TOC: " + document.myApplet.getNTransaccion() +
                            "\nResultado Transaccion: " + document.myApplet.getResultadoTRX() +
                            "\nCI Vencida: " + document.myApplet.getCIVencida());
                    fechaVencimiento = new Date(document.myApplet.getFechaVence());
                    $('#formDocumentos\\:apellidos').val(document.myApplet.getApellidoPaterno());
                    $('#formDocumentos\\:ciVencida').val(document.myApplet.getCIVencida());
                    $('#formDocumentos\\:nacionalidad').val(document.myApplet.getNacionalidad());
                    $('#formDocumentos\\:fechaVencimiento').val(document.myApplet.getFechaVence());
                    $('#formDocumentos\\:nombres').val(document.myApplet.getNombreCompleto());
                    $('#formDocumentos\\:numeroTransaccion').val(document.myApplet.getNTransaccion());
                    $('#formDocumentos\\:resultadoTransaccion').val(document.myApplet.getResultadoTRX());
                    $('#formDocumentos\\:run').val(document.myApplet.getRut());
                }
                var resultadoTransaccion = $('#formDocumentos\\:resultadoTransaccion').val();
                var ciVencida = $('#formDocumentos\\:ciVencida').val();
//                alert("resultadoTransaccion " + resultadoTransaccion +
//                        " ciVencida " + ciVencida);
                if (resultadoTransaccion == 'true') {
                    if (ciVencida == 'false') {
                        document.getElementById("btnFirmaV").disabled = false;
                    } else {
                        $('#formNotificacionError\\:descNotificacionError').text('No puedo firmar documentos con la cédula vencida');
                        $('#iframePdf').hide();
                        $('#divApplet').hide();
                        $('#notificacionError').modal('show');
                    }
                } else {
                    $('#formNotificacionError\\:descNotificacionError').text('La cédula no corresponde con la huella ingresada');
                    $('#iframePdf').hide();
                    $('#divApplet').hide();
                    $('#notificacionError').modal('show');
                }
            }

            function validacionFirma() {
                $('#iframePdf').hide();
                $('#divApplet').hide();
                if (validarSeleccionDocumento()) {
                    $('#formDocumentos\\:btnFirma').trigger('click');
                } else {
                    $('#formNotificacionError\\:descNotificacionError').text('Para poder firmar debe seleccionar al menos un documento');
                    $('#notificacionError').modal('show');
                }
            }

            function validarSeleccionDocumento() {
                var count = 0;
                $('#formDocumentos\\:tableDocumentos tr').each(function (index) {
                    if ($(this).find("input[type=checkbox]").is(':checked')) {
                        count++;
                    }
                });
                return  count > 0;
            }

            function clickarCheck() {
                var id = $('#formDocumentos\\:linkActivo').val();
                $('.check' + id).trigger('click');
                $('.check' + id)[0].checked = true;
            }

            function checkarCheck(id) {
                $('#iframePdf').hide();
                $('#divApplet').hide();
                $('body').addClass("loading");
                $('#formDocumentos\\:linkActivo').val(id);

                $('#formDocumentos\\:tableDocumentos tr').each(function (index) {
                    $(this).find("input[type=checkbox]").prop('checked', false);
                });
                if ($('.check' + id).length > 0) {
                    $('.check' + id)[0].checked = true;
                }
            }

            function enlazarLink(id) {
                $('#formDocumentos\\:tableDocumentos tr').each(function (index) {
                    $(this).find("input[type=checkbox]").prop('checked', false);
                });
                $(".link" + id).trigger("click");
            }

            function closeWindow() {
                window.open('', '_parent', '');
                window.close();
            }

            function validarConsultarDetalleDocumento(data) {
                switch (data.status) {
                    case 'success':
                        $('body').removeClass("loading");
                        $('#iframePdf').show();
                        $('#divApplet').show();
                        if ($('#formDocumentos\\:mostrarErrorConsultarDetalle').val() == 'true') {
                            $('#iframePdf').hide();
                            $('#divApplet').hide();
                            $('#notificacionErrorConsultarDetalle').modal('show');
                        }
                        break;
                    case 'begin':
                        break;
                    case 'complete':
                        break;
                }
            }
        </script>

    </h:head>
    <h:body>        
        <div class="container-fluid">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <h5 class="panel-title">Oferta Econ&#243;mica #{MbFirma.ofertaEconomica}</h5>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <h:form id="formDocumentos">
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="col-lg-5 col-md-5 col-sm-5">
                                    <div class="row">
                                        <button type="button" onclick="window.close()" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-repeat"></i> Volver</button>
                                        <button disabled="true" type="button" id="btnFirmaV"  onclick="validacionFirma()" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-ok"></i> Firmar</button>
                                        <!--<button type="button" onclick="$('#notificacionRollback').modal('show')" class="btn btn-default btn-sm"><i class="glyphicon glyphicon-trash"></i> RollBack</button>-->
                                        <h:commandButton id="btnFirma" action="#{MbFirma.firmar}" style="display: none"  styleClass="btn btn-default btn-sm" onclick="$('body').addClass('loading')"/>
                                        <!--<h:commandButton id="btnRollback" action="#{MbFirma.rollback}" style="display: none"  styleClass="btn btn-default btn-sm"/>-->
                                        <h:commandButton id="btnListar" actionListener="#{MbFirma.consultarDocumentos()}" style="display: none"  styleClass="btn btn-default btn-sm"/>
                                        <h:inputHidden id="apellidos" value="#{MbFirma.apellidos}"/>
                                        <h:inputHidden id="ciVencida" value="#{MbFirma.ciVencida}"/>
                                        <h:inputHidden id="nacionalidad" value="#{MbFirma.nacionalidad}"/>
                                        <h:inputHidden id="fechaNacimiento" value="#{MbFirma.fechaNacimiento}"/>
                                        <h:inputHidden id="fechaVencimiento" value="#{MbFirma.fechaVencimiento}"/>
                                        <h:inputHidden id="genero" value="#{MbFirma.genero}"/>
                                        <h:inputHidden id="nombres" value="#{MbFirma.nombres}"/>
                                        <h:inputHidden id="numeroSerie" value="#{MbFirma.numeroSerie}"/>
                                        <h:inputHidden id="numeroTransaccion" value="#{MbFirma.numeroTransaccion}"/>
                                        <h:inputHidden id="resultadoTransaccion" value="#{MbFirma.resultadoTransaccion}"/>
                                        <h:inputHidden id="run" value="#{MbFirma.run}"/>
                                        <h:inputHidden id="tipoCedula" value="#{MbFirma.tipoCedula}"/>
                                        <h:inputHidden id="estadoCargaVista" value="#{MbFirma.estadoCargaVista}"/>
                                        <h:inputHidden id="estadoInicioApplet" value="#{MbFirma.estadoInicioApplet}"/>
                                        <h:inputHidden id="estadoRegistro" value="#{MbFirma.estadoRegistro}"/>
                                        <h:inputHidden id="linkActivo" />
                                        <h:inputHidden id="mostrarErrorConsultarDetalle" value="#{MbFirma.mostrarErrorConsultarDetalle}"/>
                                    </div>
                                    <br />
                                    <div id="divApplet" class="row">
                                        <applet code="jtoc\v3\Main" name="myApplet" archive="jtocv3.jar" width="540" height="160">
                                            <PARAM name="URLTOC" value="http://web.tocbiometrics.com/tocwebsv/ver3/wsTOC3.php" />
                                            <PARAM name="URLNUEVACI" value="http://web.tocbiometrics.com/tocwebsv/wsTOCNewCI.php" />
                                            <PARAM name="URLCHILENOS" value="https://web.tocbiometrics.com:8443/wsTOCChileans/ChileansWS" />

                                            <PARAM name="CancelarVisible" value="false" />

                                            <PARAM name="java_version" value="1.6+" />
                                            <PARAM name="separate_jvm" value="true" />
                                        </applet>

                                    </div>	

                                </div>
                                <div class="col-lg-7 col-md-7 col-sm-7 ">
                                    <h5 class="panel-title" style="margin-left: -15px">Documentos Pendientes</h5> 
                                    <div class="row pre-scrollable" style="max-height: 190px;">
                                        <h:dataTable styleClass="table table-striped" style="font-size: 10px; margin-top: 33px;" id="tableDocumentos" value="#{MbFirma.documentos}" var="o" >
                                            <h:column>
                                                <f:facet name="header">
                                                    Seleccione
                                                </f:facet>
                                                <h:selectBooleanCheckbox rendered="#{o.flagFirmaDigital=='Y'}" value="#{o.seleccionado}" onclick="enlazarLink(#{o.id})" styleClass="check#{o.id}"/>
                                                <h:selectBooleanCheckbox disabled="true" rendered="#{o.flagFirmaDigital=='N' or o.flagFirmaDigital=='I' } " value="#{o.seleccionado}" onclick="enlazarLink(#{o.id})" styleClass="check#{o.id}"/>
                                            </h:column>
                                            <h:column >
                                                <f:facet name="header">
                                                    Documento
                                                </f:facet>                                      
                                                <h:commandLink  rendered="#{o.flagFirmaDigital=='Y'}"  value="#{o.nombreDocumento}" styleClass="link#{o.id} link-activo " onclick="checkarCheck(#{o.id})">
                                                    <f:ajax onevent="validarConsultarDetalleDocumento" render="tableDocumentos :iframePdf" listener="#{MbFirma.consultarDetalleDocumento(o.idActividad,o.flagFirmaDigital)}"/>
                                                </h:commandLink>
                                                <h:commandLink  rendered="#{o.flagFirmaDigital=='N'}"  value="#{o.nombreDocumento}" styleClass="link#{o.id} link-inactivo" onclick="checkarCheck(#{o.id})">
                                                    <f:ajax onevent="validarConsultarDetalleDocumento" render="tableDocumentos :iframePdf" listener="#{MbFirma.consultarDetalleDocumento(o.idActividad,o.flagFirmaDigital)}"/>
                                                </h:commandLink>                                                
                                                <h:commandLink  rendered="#{o.flagFirmaDigital=='I'}"  value="#{o.nombreDocumento}" styleClass="link#{o.id} link-inactivo" onclick="checkarCheck(#{o.id})">
                                                    <f:ajax onevent="validarConsultarDetalleDocumento" render="tableDocumentos :iframePdf" listener="#{MbFirma.consultarDetalleDocumentoI(o.idActividad,o.flagFirmaDigital)}"/>
                                                </h:commandLink>
                                            </h:column> 
                                            <h:column>
                                                <f:facet name="header">
                                                    Estado Firma
                                                </f:facet>
                                                <h:outputText  rendered="#{o.flagFirmaDigital=='Y'}"  value="Por Firmar" />
                                                <h:outputText  rendered="#{o.flagFirmaDigital=='I'}"  value="Imposible Firmar" />
                                                <h:outputText  rendered="#{o.flagFirmaDigital=='N'}"  value="Firmado" />                                               
                                            </h:column>  
                                        </h:dataTable>
                                    </div>	
                                </div>

                            </div>
                        </h:form>
                    </div>
                    <hr />
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12">
                            <h:panelGroup id="iframePdf" layout="block">
                                <iframe class="pdf" id="iframePdf" src="#{request.contextPath}/ServletDetalleDocumentoPdf?actividad=#{idActividad}&amp;flagFirma=#{flagFirma}"/>
                            </h:panelGroup>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div id="notificacionError" class="modal fade" tabindex="-1" role="dialog"
             aria-labelledby="gridSystemModalLabel">
            <h:form id="formNotificacionError">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">X</span>
                            </button>

                            <h4 class="modal-title" id="gridSystemModalLabel">Error</h4>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-12">
                                    <h5> <h:outputText id="descNotificacionError"/>.</h5>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <a href="#" class="btn btn-primary" onclick="$('#iframePdf').show();
                                    $('#divApplet').show();
                                    $('#notificacionError').modal('hide')">Aceptar</a>
                        </div>
                    </div>
                </div>
            </h:form>
        </div>



        <div id="notificacionRollback" class="modal fade" tabindex="-1" role="dialog"
             aria-labelledby="gridSystemModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">X</span>
                        </button>

                        <h4 class="modal-title" id="gridSystemModalLabel">Notificaci&#243;n</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-12">
                                <h5>Si realiza el rollback de la firma de los documentos ya no podr&#225; volver a firmar digitalmente y obligatoriamente deber&#225; firmar los documentos de forma manual ¿Confirma que desea realizar el rollback de las firmas?.</h5>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <a href="#" class="btn btn-primary" onclick="$('#iframePdf').show();
                                $('#divApplet').show();
                                $('#notificacionRollback').modal('hide');
                                $('#formDocumentos\\:btnRollback').trigger('click');">Si</a>
                        <a href="#" class="btn btn-primary" onclick="$('#iframePdf').show();
                                $('#divApplet').show();
                                $('#notificacionRollback').modal('hide')">No</a>
                    </div>
                </div>
            </div>
        </div>


        <div id="notificacionFirmados" class="modal fade" tabindex="-1" role="dialog"
             aria-labelledby="gridSystemModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">X</span>
                        </button>

                        <h4 class="modal-title" id="gridSystemModalLabel">Notificaci&#243;n</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-12">
                                <h5> <h:outputText value="#{MbFirma.mensajeFirmados}"/></h5>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <a href="#" class="btn btn-primary" onclick="$('#iframePdf').show();
                                $('#divApplet').show();
                                $('#notificacionFirmados').modal('hide');
                                window.close()">Aceptar</a>
                    </div>
                </div>
            </div>
        </div>


        <div id="notificacionErrorApplet" class="modal fade" tabindex="-1" role="dialog"
             aria-labelledby="gridSystemModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">X</span>
                        </button>

                        <h4 class="modal-title" id="gridSystemModalLabel">Notificaci&#243;n</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-12">
                                <h5> Error al tratar de iniciar el applet de TOC.</h5>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <a href="#" class="btn btn-primary" onclick="$('#iframePdf').show();
                                $('#divApplet').show();
                                $('#notificacionErrorApplet').modal('hide');
                                window.close()">Aceptar</a>  
                    </div>
                </div>
            </div>
        </div>




        <div id="notificacionErrorListar" class="modal fade" tabindex="-1" role="dialog"
             aria-labelledby="gridSystemModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">X</span>
                        </button>

                        <h4 class="modal-title" id="gridSystemModalLabel">Notificaci&#243;n</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-12">
                                <h5><h:outputText value="#{MbFirma.mensajeErrorListar}"/></h5>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <h:panelGroup rendered="#{not MbFirma.mostrarBotonOKErrorListar}">
                            <a href="index.xhtml" class="btn btn-primary" onclick="$('#iframePdf').show();
                                    $('#divApplet').show();
                                    $('#notificacionErrorListar').modal('hide');">Si</a>
                            <a href="#" class="btn btn-primary" onclick="$('#iframePdf').show();
                                    $('#divApplet').show();
                                    $('#notificacionErrorListar').modal('hide');
                                    closeWindow()">No</a>
                        </h:panelGroup>
                        <h:panelGroup rendered="#{MbFirma.mostrarBotonOKErrorListar}">
                            <a href="#" class="btn btn-primary" onclick="$('#iframePdf').show();
                                    $('#divApplet').show();
                                    $('#notificacionErrorListar').modal('hide')">OK</a>
                        </h:panelGroup>
                    </div>
                </div>
            </div>
        </div>


        <div id="notificacionErrorFirmar" class="modal fade" tabindex="-1" role="dialog"
             aria-labelledby="gridSystemModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">X</span>
                        </button>

                        <h4 class="modal-title" id="gridSystemModalLabel">Notificaci&#243;n</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-12">
                                <h5> #{MbFirma.mensajeErrorFirmar} ¿Confirma que desea realizar el reintento del proceso firmar documento?.</h5>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <a href="#" class="btn btn-primary" onclick="$('#iframePdf').show();
                                $('#divApplet').show();
                                $('#notificacionErrorFirmar').modal('hide');
                                $('#formDocumentos\\:btnFirma').trigger('click')">Si</a>
                        <a href="#" class="btn btn-primary" onclick="$('#iframePdf').show();
                                $('#divApplet').show();
                                $('#notificacionErrorFirmar').modal('hide')">No</a>
                    </div>
                </div>
            </div>
        </div>

        <div id="notificacionErrorConsultarDetalle" class="modal fade" tabindex="-1" role="dialog"
             aria-labelledby="gridSystemModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">X</span>
                        </button>

                        <h4 class="modal-title" id="gridSystemModalLabel">Notificaci&#243;n</h4>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-12">
                                <h5>Error interno al tratar de consultar el detalle del documento ¿Confirma que desea realizar el reintento del proceso de consultar el detalle del documento?.</h5>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <a href="#" class="btn btn-primary" onclick="$('#iframePdf').show();
                                $('#divApplet').show();
                                $('#notificacionErrorConsultarDetalle').modal('hide');
                                clickarCheck()">Si</a>
                        <a href="#" class="btn btn-primary" onclick="$('#iframePdf').show();
                                $('#divApplet').show();
                                $('#notificacionErrorConsultarDetalle').modal('hide')">No</a>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal1"><h5>Estamos procesando su solicitud por favor espere...</h5></div>

        <script>
            $(document).ready(function () {

                $('#iframePdf').show();
                $('#divApplet').show();

                if (#{MbFirma.mostrarFirmados}) {
                    $('#iframePdf').hide();
                    $('#divApplet').hide();
                    $('#notificacionFirmados').modal('show');
                }
                if (#{MbFirma.mostrarErrorListar}) {
                    $('#iframePdf').hide();
                    $('#divApplet').hide();
                    $('#notificacionErrorListar').modal('show');
                }
                if (#{MbFirma.mostrarErrorFirmar}) {
                    $('#iframePdf').hide();
                    $('#divApplet').hide();
                    $('#notificacionErrorFirmar').modal('show');
                }
            });
        </script>
    </h:body>
</html>
